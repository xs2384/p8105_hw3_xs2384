HW3
================
Xinyu Shen

``` r
library(tidyverse)
```

    ## ── Attaching packages ──────────────────────────────────────────────────────────────────────────── tidyverse 1.2.1 ──

    ## ✔ ggplot2 3.2.1          ✔ purrr   0.3.2     
    ## ✔ tibble  2.1.3          ✔ dplyr   0.8.3     
    ## ✔ tidyr   1.0.0.9000     ✔ stringr 1.4.0     
    ## ✔ readr   1.3.1          ✔ forcats 0.4.0

    ## ── Conflicts ─────────────────────────────────────────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()

``` r
library(p8105.datasets)
data("instacart")
```

The dataset instacart has dimention of 1384617 X 15. It has 1384617 variables, which are order\_id, product\_id, add\_to\_cart\_order, reordered, user\_id, eval\_set, order\_number, order\_dow, order\_hour\_of\_day, days\_since\_prior\_order, product\_name, aisle\_id, department\_id, aisle, department. The key variables is the product\_name, which help us to locate the product we want. The product\_id variable can help us easily count how many such products were purchased, so it is important as well. For example, if the seller want to know how popular the spring water is, the seller can use the product name to locate the product and get its product id. Then the seller can count how many times this product id shows in the datasets, to know how popular the product is.

``` r
aisles_count = length(unique(pull(instacart, "aisle")))
df_most_item_aisle = instacart %>% group_by(aisle_id) %>% summarize(n=n()) 
most_item_aisle=max(df_most_item_aisle$n)
most_aisle_id = df_most_item_aisle$aisle_id[which(df_most_item_aisle$n==max(most_item_aisle))]
most_aisle_name = filter(instacart, aisle_id == most_aisle_id)[["aisle"]][1]
```

``` r
df_item_aisles = instacart %>% group_by(aisle) %>% summarize(n=n()) 
item_plot = filter(df_item_aisles, n>10000) %>% mutate( 
  aisle= as.ordered(aisle)
  )
ggplot(item_plot, aes(x= aisle, y= n )) + geom_bar(stat = "identity")+ ylab("number in aisles") + coord_flip() +
  scale_x_discrete(limits = rev(levels(item_plot$aisle)))
```

![](p8105_hw3_xs2384_files/figure-markdown_github/unnamed-chunk-3-1.png)

``` r
df_three_most = instacart %>% filter(aisle %in% c("baking ingredients", "dog food care","packaged vegetables fruits")) %>% group_by(aisle, product_name) %>% summarize(num_times=n()) %>% arrange(-num_times, .by_group = TRUE) %>% top_n(3)
df_three_most
```

    ## # A tibble: 9 x 3
    ## # Groups:   aisle [3]
    ##   aisle                   product_name                            num_times
    ##   <chr>                   <chr>                                       <int>
    ## 1 baking ingredients      Light Brown Sugar                             499
    ## 2 baking ingredients      Pure Baking Soda                              387
    ## 3 baking ingredients      Cane Sugar                                    336
    ## 4 dog food care           Snack Sticks Chicken & Rice Recipe Dog…        30
    ## 5 dog food care           Organix Chicken & Brown Rice Recipe            28
    ## 6 dog food care           Small Dog Biscuits                             26
    ## 7 packaged vegetables fr… Organic Baby Spinach                         9784
    ## 8 packaged vegetables fr… Organic Raspberries                          5546
    ## 9 packaged vegetables fr… Organic Blueberries                          4966

``` r
df_p_c = instacart %>% filter(product_name %in% c('Pink Lady Apples', 'Coffee Ice Cream')) %>% select(product_name,order_dow, order_hour_of_day) %>% group_by(product_name, order_dow) %>% summarize(mean = mean(order_hour_of_day)) %>% pivot_wider(names_from = order_dow, values_from = mean) 
df_p_c
```

    ## # A tibble: 2 x 8
    ## # Groups:   product_name [2]
    ##   product_name       `0`   `1`   `2`   `3`   `4`   `5`   `6`
    ##   <chr>            <dbl> <dbl> <dbl> <dbl> <dbl> <dbl> <dbl>
    ## 1 Coffee Ice Cream  13.8  14.3  15.4  15.3  15.2  12.3  13.8
    ## 2 Pink Lady Apples  13.4  11.4  11.7  14.2  11.6  12.8  11.9
